#!/usr/bin/env bash

HELP_TEXT="Usage: bin/run TIER"
RED="\033[0;31m"
NC="\033[0m" # No Color

if [ -n "$1" ]
then
  TIER=$1
else
  echo -e "${RED}Must specify TIER (dev, prod)${NC}"
  echo -e $HELP_TEXT
  echo ""
  exit 1
fi

echo "...Running on TIER $TIER"

ansible-playbook \
  --ask-pass \
  --ask-become-pass \
  --vault-password-file ./vault-password \
  --user=ansible \
  --limit $TIER \
  --inventory=hosts.ini \
  plays/tunnel.yml
